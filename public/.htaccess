RewriteEngine on
RewriteBase /

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule ^(.*)$ index.php

<Files .htaccess>
order allow,deny
deny from all
</Files>

<Files ~ "^(index)\.(p?s?x?htm?|txt|aspx?|cfml?|cgi|pl|php[3-9]|jsp|xml)$">
order allow,deny
deny from all
</Files>

#------------------------------------------------------------------------------
# Use codificação UTF-8 para qualquer coisa como text/plain ou text/html
#------------------------------------------------------------------------------
AddDefaultCharset utf-8

#------------------------------------------------------------------------------
# Ativa mod_rewrite usado em filtros contra certos robôs piratas
#------------------------------------------------------------------------------
RewriteEngine On

#------------------------------------------------------------------------------
# Exceção de tipos de arquivos que robôs podem acessar
#------------------------------------------------------------------------------
RewriteCond %{REQUEST_URI} !^/robots.txt
RewriteCond %{REQUEST_URI} !^/sitemap.xml

#------------------------------------------------------------------------------
# Bloqueio contra softwares que baixam páginas do site para navegação off-line
#------------------------------------------------------------------------------
RewriteCond %{HTTP_USER_AGENT} ^-?$ [OR] 

#------------------------------------------------------------------------------
# Bloqueio contra tipos de requisição gerados por robôs
#------------------------------------------------------------------------------
RewriteCond %{HTTP_USER_AGENT} ^curl|^Fetch\ API\ Request|GT\:\:WWW|^HTTP\:\:Lite|httplib|^Java/1.|^Java\ 1.|^LWP|libWeb|libwww|^PEAR|PECL\:\:HTTP|PHPCrawl|python|Rsync|Snoopy|^URI\:\:Fetch|WebDAV|^Wget [NC] 
RewriteRule (.*) - [F]

#------------------------------------------------------------------------------
# Proíbe a exibição de certos arquivos de configuração como login, config, adm
#------------------------------------------------------------------------------
<Files ~ "^(install?|admin|(wp-)?config(\.inc)?|configure|configuration|login|logging|options?\.inc|option|settings?(\.inc)?|functions?(\.inc)?|setup(\.inc)?|default|home|main|errors?|members?|hacke?r?d?|[-_a-z0-9.]*mafia[-_a-z0-9.]*|[-_a-z0-9.]*power[-_a-z0-9.]*|[-_a-z0-9.]*jihad[-_a-z0-9.]*|php|shell|ssh|root|cmd|[0-9]{1,6}|test|data)\.(p?s?x?htm?l?|txt|aspx?|cfml?|cgi|pl|php[3-9]{0,1}|jsp?|sql|xml)$">
order allow,deny
deny from all
</Files>

#------------------------------------------------------------------------------
# Código para neutralizar URLs falsas
#------------------------------------------------------------------------------
RedirectMatch gone ^/_vti.*
RedirectMatch gone ^/MSOffice.*
RedirectMatch gone ^[-_a-z0-9/\.]*//.*
RedirectMatch gone ^.*/etc/passwd.*

RewriteRule ^.*EXEC\(@.*$        - [R=404,L,NC]
RewriteRule ^.*CAST\(.*$         - [R=404,L,NC]
RewriteRule ^.*DECLARE.*$        - [R=404,L,NC] 
RewriteRule ^.*DECLARE%20.*$     - [R=404,L,NC]
RewriteRule ^.*NVARCHAR.*$       - [R=404,L,NC] 
RewriteRule ^.*sp_password.*$    - [R=404,L,NC]
RewriteRule ^.*%20xp_.*$         - [R=404,L,NC]

#------------------------------------------------------------------------------
# Filtro contra phpshell.php, RemoteView, C99.php, r57.php, etc
#------------------------------------------------------------------------------
RewriteEngine On
RewriteCond %{REQUEST_URI} .*((php|my)?shell|remview.*|phpremoteview.*|sshphp.*|pcom|nstview.*|c99|r57|webadmin.*|phpget.*|phpwriter.*|fileditor.*|locus7.*|storm7.*)\.(p?s?x?htm?l?|txt|aspx?|cfml?|cgi|pl|php[3-9]{0,1}|jsp?|sql|xml) [NC,OR]
RewriteCond %{REQUEST_METHOD} (GET|POST) [NC]
RewriteCond %{QUERY_STRING} ^(.*)=/home/wwwindus/public_html/(.*)$ [OR]
RewriteCond %{QUERY_STRING} ^work_dir=.*$ [OR]
RewriteCond %{QUERY_STRING} ^command=.*&output.*$ [OR]
RewriteCond %{QUERY_STRING} ^nts_[a-z0-9_]{0,10}=.*$ [OR]
RewriteCond %{QUERY_STRING} ^(.*)cmd=.*$ [OR] 

